<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegram Mini App</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            background: #ffffff;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .spinner {
            width: 60px;
            height: 60px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        #content {
            width: 100%;
            text-align: center;
        }
    </style>
</head>
<body>
    <div id="content">
        <div class="spinner"></div>
    </div>

    <script>
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ startapp –∏–∑ Telegram Web App API
        function getStartParam() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å Telegram Web App API
            if (window.Telegram && window.Telegram.WebApp) {
                // –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π —Å–ø–æ—Å–æ–± –ø–æ–ª—É—á–µ–Ω–∏—è start_param
                if (window.Telegram.WebApp.initData) {
                    const initData = new URLSearchParams(window.Telegram.WebApp.initData);
                    return initData.get('start_param') || '';
                }
                // –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± —á–µ—Ä–µ–∑ initDataUnsafe
                else if (window.Telegram.WebApp.initDataUnsafe && window.Telegram.WebApp.initDataUnsafe.start_param) {
                    return window.Telegram.WebApp.initDataUnsafe.start_param;
                }
            }

            // Fallback –Ω–∞ URL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤–Ω–µ Telegram
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get('startapp') || '';
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö Telegram
        function getTelegramData() {
            const data = {
                isAvailable: false,
                isReady: false,
                user: null,
                startParam: '',
                initData: '',
                platform: '',
                version: '',
                theme: null,
                viewportHeight: 0,
                viewportStableHeight: 0
            };

            if (window.Telegram && window.Telegram.WebApp) {
                data.isAvailable = true;
                data.isReady = window.Telegram.WebApp.isReady || false;
                data.user = window.Telegram.WebApp.initDataUnsafe?.user || null;
                data.startParam = getStartParam();
                data.initData = window.Telegram.WebApp.initData || '';
                data.platform = window.Telegram.WebApp.platform || '';
                data.version = window.Telegram.WebApp.version || '';
                data.theme = window.Telegram.WebApp.themeParams || null;
                data.viewportHeight = window.Telegram.WebApp.viewportHeight || 0;
                data.viewportStableHeight = window.Telegram.WebApp.viewportStableHeight || 0;
            }

            return data;
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è HTML —Å –¥–∞–Ω–Ω—ã–º–∏ Telegram
        function createTelegramDataHTML(data) {
            if (!data.isAvailable) {
                return '<p><strong>Telegram Web App API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω</strong></p>';
            }

            let html = '<div style="background: #f5f5f5; padding: 15px; border-radius: 8px; margin: 10px 0; font-family: monospace; font-size: 12px;">';
            html += '<h3>üì± Telegram Data:</h3>';

            if (data.user) {
                html += '<h4>üë§ User Info:</h4>';
                html += '<ul>';
                html += '<li><strong>ID:</strong> ' + (data.user.id || 'N/A') + '</li>';
                html += '<li><strong>First Name:</strong> ' + (data.user.first_name || 'N/A') + '</li>';
                html += '<li><strong>Last Name:</strong> ' + (data.user.last_name || 'N/A') + '</li>';
                html += '<li><strong>Username:</strong> ' + (data.user.username || 'N/A') + '</li>';
                html += '<li><strong>Language:</strong> ' + (data.user.language_code || 'N/A') + '</li>';
                html += '</ul>';
            }

            html += '<h4>üîß App Info:</h4>';
            html += '<ul>';
            html += '<li><strong>Start Param:</strong> "' + (data.startParam || '–ø—É—Å—Ç–æ–π') + '"</li>';
            html += '<li><strong>Platform:</strong> ' + (data.platform || 'N/A') + '</li>';
            html += '<li><strong>Version:</strong> ' + (data.version || 'N/A') + '</li>';
            html += '<li><strong>Is Ready:</strong> ' + (data.isReady ? '‚úÖ –î–∞' : '‚ùå –ù–µ—Ç') + '</li>';
            html += '<li><strong>Viewport Height:</strong> ' + data.viewportHeight + '</li>';
            html += '<li><strong>Viewport Stable Height:</strong> ' + data.viewportStableHeight + '</li>';
            html += '</ul>';

            if (data.theme) {
                html += '<h4>üé® Theme:</h4>';
                html += '<ul>';
                html += '<li><strong>Background:</strong> ' + (data.theme.bg_color || 'N/A') + '</li>';
                html += '<li><strong>Text:</strong> ' + (data.theme.text_color || 'N/A') + '</li>';
                html += '<li><strong>Button:</strong> ' + (data.theme.button_color || 'N/A') + '</li>';
                html += '</ul>';
            }

            if (data.initData) {
                html += '<h4>üìã Init Data:</h4>';
                html += '<div style="background: white; padding: 8px; border-radius: 4px; word-break: break-all; max-height: 100px; overflow-y: auto;">';
                html += data.initData;
                html += '</div>';
            }

            html += '</div>';
            return html;
        }

        // –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞
        function handleRedirect() {
            const startParam = getStartParam();

            if (startParam === 'menu1') {
                // –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—É—é —Å—Å—ã–ª–∫—É
                window.location.href = 'https://eatandsplit.com/?menu=8b82d97a-7db8-4394-9bdd-cfeb8558747d';
            } else {
                // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ Telegram –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å hello
                const telegramData = getTelegramData();
                const telegramDataHTML = createTelegramDataHTML(telegramData);

                let content = '<h1>Hello</h1>';

                if (startParam !== '') {
                    content += '<p>Unknown parameter: ' + startParam + '</p>';
                }

                content += telegramDataHTML;

                document.getElementById('content').innerHTML = content;
            }
        }

        // –í—ã–ø–æ–ª–Ω—è–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('load', function() {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Telegram Web App
            if (window.Telegram && window.Telegram.WebApp) {
                window.Telegram.WebApp.ready();

                // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –ø–æ–ª–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
                setTimeout(handleRedirect, 100);
            } else {
                // –ï—Å–ª–∏ API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –ø—Ä–æ–±—É–µ–º –µ—â–µ —Ä–∞–∑ —á–µ—Ä–µ–∑ –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è
                setTimeout(function() {
                    if (window.Telegram && window.Telegram.WebApp) {
                        window.Telegram.WebApp.ready();
                    }
                    handleRedirect();
                }, 500);
            }
        });
    </script>
</body>
</html>
